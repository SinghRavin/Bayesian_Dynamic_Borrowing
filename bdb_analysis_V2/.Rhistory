`Heterogeneity_Level`==9~"80% more",
`Heterogeneity_Level`==10~"Opposite"))
data_full <- data_full |>
dplyr::select("Heterogeneity_Level_Description", "Heterogeneity_Level", "Iteration", "ID")
# Let's simulate the covariates.
N=num_het_conds*num_iters*num_subjs
# 6 baseline measured covariates
age <- rnorm(n=N, mean=60, sd=10) |> round(0)
female <- rbern(n=N, prob=0.25)
bmi <- rnorm(n=N, mean=22, sd=4) |> round(3)
liver_mets <- rbern(n=N, prob=0.60)
hepatic_imp <- rbern(n=N, prob=0.20)
num_mets_morethan2 <- rbern(n=N, prob=0.85)
# 1 baseline unmeasured covariate
u <- rnorm(n=N, mean=0, sd=1)
data_full <- data_full |>
mutate(Intercept=1,
Age=age,
Female=female,
BMI=bmi,
Liver_Mets=liver_mets,
Hepatic_Imp=hepatic_imp,
Num_Mets_MoreThan2=num_mets_morethan2,
U=u)
# Outcome simulation constants.
# lambda = scale parameter in baseline weibull distribution.
# rho = shape parameter in baseline weibull distribution.
# rateC = rate parameter of the exponential distribution of censoring times.
lambda = 0.01
rho = 1
rateC = 0.005
coef_I = c(rep(het_conds_coef_list[[1]][1], num_iters*num_subjs),
rep(het_conds_coef_list[[2]][1], num_iters*num_subjs),
rep(het_conds_coef_list[[3]][1], num_iters*num_subjs),
rep(het_conds_coef_list[[4]][1], num_iters*num_subjs),
rep(het_conds_coef_list[[5]][1], num_iters*num_subjs),
rep(het_conds_coef_list[[6]][1], num_iters*num_subjs),
rep(het_conds_coef_list[[7]][1], num_iters*num_subjs),
rep(het_conds_coef_list[[8]][1], num_iters*num_subjs),
rep(het_conds_coef_list[[9]][1], num_iters*num_subjs),
rep(het_conds_coef_list[[10]][1], num_iters*num_subjs))
coef_Age = c(rep(het_conds_coef_list[[1]][2], num_iters*num_subjs),
rep(het_conds_coef_list[[2]][2], num_iters*num_subjs),
rep(het_conds_coef_list[[3]][2], num_iters*num_subjs),
rep(het_conds_coef_list[[4]][2], num_iters*num_subjs),
rep(het_conds_coef_list[[5]][2], num_iters*num_subjs),
rep(het_conds_coef_list[[6]][2], num_iters*num_subjs),
rep(het_conds_coef_list[[7]][2], num_iters*num_subjs),
rep(het_conds_coef_list[[8]][2], num_iters*num_subjs),
rep(het_conds_coef_list[[9]][2], num_iters*num_subjs),
rep(het_conds_coef_list[[10]][2], num_iters*num_subjs))
coef_Female = c(rep(het_conds_coef_list[[1]][3], num_iters*num_subjs),
rep(het_conds_coef_list[[2]][3], num_iters*num_subjs),
rep(het_conds_coef_list[[3]][3], num_iters*num_subjs),
rep(het_conds_coef_list[[4]][3], num_iters*num_subjs),
rep(het_conds_coef_list[[5]][3], num_iters*num_subjs),
rep(het_conds_coef_list[[6]][3], num_iters*num_subjs),
rep(het_conds_coef_list[[7]][3], num_iters*num_subjs),
rep(het_conds_coef_list[[8]][3], num_iters*num_subjs),
rep(het_conds_coef_list[[9]][3], num_iters*num_subjs),
rep(het_conds_coef_list[[10]][3], num_iters*num_subjs))
coef_BMI = c(rep(het_conds_coef_list[[1]][4], num_iters*num_subjs),
rep(het_conds_coef_list[[2]][4], num_iters*num_subjs),
rep(het_conds_coef_list[[3]][4], num_iters*num_subjs),
rep(het_conds_coef_list[[4]][4], num_iters*num_subjs),
rep(het_conds_coef_list[[5]][4], num_iters*num_subjs),
rep(het_conds_coef_list[[6]][4], num_iters*num_subjs),
rep(het_conds_coef_list[[7]][4], num_iters*num_subjs),
rep(het_conds_coef_list[[8]][4], num_iters*num_subjs),
rep(het_conds_coef_list[[9]][4], num_iters*num_subjs),
rep(het_conds_coef_list[[10]][4], num_iters*num_subjs))
coef_Liver_Mets = c(rep(het_conds_coef_list[[1]][5], num_iters*num_subjs),
rep(het_conds_coef_list[[2]][5], num_iters*num_subjs),
rep(het_conds_coef_list[[3]][5], num_iters*num_subjs),
rep(het_conds_coef_list[[4]][5], num_iters*num_subjs),
rep(het_conds_coef_list[[5]][5], num_iters*num_subjs),
rep(het_conds_coef_list[[6]][5], num_iters*num_subjs),
rep(het_conds_coef_list[[7]][5], num_iters*num_subjs),
rep(het_conds_coef_list[[8]][5], num_iters*num_subjs),
rep(het_conds_coef_list[[9]][5], num_iters*num_subjs),
rep(het_conds_coef_list[[10]][5], num_iters*num_subjs))
coef_Hepatic_Imp = c(rep(het_conds_coef_list[[1]][6], num_iters*num_subjs),
rep(het_conds_coef_list[[2]][6], num_iters*num_subjs),
rep(het_conds_coef_list[[3]][6], num_iters*num_subjs),
rep(het_conds_coef_list[[4]][6], num_iters*num_subjs),
rep(het_conds_coef_list[[5]][6], num_iters*num_subjs),
rep(het_conds_coef_list[[6]][6], num_iters*num_subjs),
rep(het_conds_coef_list[[7]][6], num_iters*num_subjs),
rep(het_conds_coef_list[[8]][6], num_iters*num_subjs),
rep(het_conds_coef_list[[9]][6], num_iters*num_subjs),
rep(het_conds_coef_list[[10]][6], num_iters*num_subjs))
coef_Num_Mets_MoreThan2 = c(rep(het_conds_coef_list[[1]][7], num_iters*num_subjs),
rep(het_conds_coef_list[[2]][7], num_iters*num_subjs),
rep(het_conds_coef_list[[3]][7], num_iters*num_subjs),
rep(het_conds_coef_list[[4]][7], num_iters*num_subjs),
rep(het_conds_coef_list[[5]][7], num_iters*num_subjs),
rep(het_conds_coef_list[[6]][7], num_iters*num_subjs),
rep(het_conds_coef_list[[7]][7], num_iters*num_subjs),
rep(het_conds_coef_list[[8]][7], num_iters*num_subjs),
rep(het_conds_coef_list[[9]][7], num_iters*num_subjs),
rep(het_conds_coef_list[[10]][7], num_iters*num_subjs))
coef_U = c(rep(het_conds_coef_list[[1]][8], num_iters*num_subjs),
rep(het_conds_coef_list[[2]][8], num_iters*num_subjs),
rep(het_conds_coef_list[[3]][8], num_iters*num_subjs),
rep(het_conds_coef_list[[4]][8], num_iters*num_subjs),
rep(het_conds_coef_list[[5]][8], num_iters*num_subjs),
rep(het_conds_coef_list[[6]][8], num_iters*num_subjs),
rep(het_conds_coef_list[[7]][8], num_iters*num_subjs),
rep(het_conds_coef_list[[8]][8], num_iters*num_subjs),
rep(het_conds_coef_list[[9]][8], num_iters*num_subjs),
rep(het_conds_coef_list[[10]][8], num_iters*num_subjs))
v = runif(n=N)
C = rexp(n=N, rate=rateC)
data_full <- data_full |>
mutate(v=v,
coef_I = coef_I,
coef_Age = coef_Age,
coef_Female = coef_Female,
coef_BMI = coef_BMI,
coef_Liver_Mets = coef_Liver_Mets,
coef_Hepatic_Imp = coef_Hepatic_Imp,
coef_Num_Mets_MoreThan2 = coef_Num_Mets_MoreThan2,
coef_U = coef_U,
C=C)
data_full <- data_full |>
mutate(exp_prod_sum = exp(coef_I*Intercept + coef_Age*Age +
coef_Female*Female + coef_BMI*BMI +
coef_Liver_Mets*Liver_Mets + coef_Hepatic_Imp*Hepatic_Imp +
coef_Num_Mets_MoreThan2*Num_Mets_MoreThan2 + coef_U*U))
data_full <- data_full |>
mutate(Tlat = (-log(v)/(lambda*exp_prod_sum))^(1/rho))
data_full <- data_full |>
mutate(time = pmin(Tlat, C),
status = as.numeric(Tlat <= C))
data_200 <- data_full
num_subjs <- 250 # number of different subjects
data_full <- expand.grid(1:num_subjs, 1:num_iters, 1:num_het_conds)
names(data_full) <- c("ID", "Iteration", "Heterogeneity_Level")
data_full <- data_full |>
dplyr::select("Heterogeneity_Level", "Iteration", "ID")
data_full <- data_full |>
mutate(`Heterogeneity_Level_Description` = case_when(`Heterogeneity_Level`==1~"80% less",
`Heterogeneity_Level`==2~"50% less",
`Heterogeneity_Level`==3~"20% less",
`Heterogeneity_Level`==4~"10% less",
`Heterogeneity_Level`==5~"Same",
`Heterogeneity_Level`==6~"10% more",
`Heterogeneity_Level`==7~"20% more",
`Heterogeneity_Level`==8~"50% more",
`Heterogeneity_Level`==9~"80% more",
`Heterogeneity_Level`==10~"Opposite"))
data_full <- data_full |>
dplyr::select("Heterogeneity_Level_Description", "Heterogeneity_Level", "Iteration", "ID")
# Let's simulate the covariates.
N=num_het_conds*num_iters*num_subjs
# 6 baseline measured covariates
age <- rnorm(n=N, mean=60, sd=10) |> round(0)
female <- rbern(n=N, prob=0.25)
bmi <- rnorm(n=N, mean=22, sd=4) |> round(3)
liver_mets <- rbern(n=N, prob=0.60)
hepatic_imp <- rbern(n=N, prob=0.20)
num_mets_morethan2 <- rbern(n=N, prob=0.85)
# 1 baseline unmeasured covariate
u <- rnorm(n=N, mean=0, sd=1)
data_full <- data_full |>
mutate(Intercept=1,
Age=age,
Female=female,
BMI=bmi,
Liver_Mets=liver_mets,
Hepatic_Imp=hepatic_imp,
Num_Mets_MoreThan2=num_mets_morethan2,
U=u)
# Outcome simulation constants.
# lambda = scale parameter in baseline weibull distribution.
# rho = shape parameter in baseline weibull distribution.
# rateC = rate parameter of the exponential distribution of censoring times.
lambda = 0.01
rho = 1
rateC = 0.005
coef_I = c(rep(het_conds_coef_list[[1]][1], num_iters*num_subjs),
rep(het_conds_coef_list[[2]][1], num_iters*num_subjs),
rep(het_conds_coef_list[[3]][1], num_iters*num_subjs),
rep(het_conds_coef_list[[4]][1], num_iters*num_subjs),
rep(het_conds_coef_list[[5]][1], num_iters*num_subjs),
rep(het_conds_coef_list[[6]][1], num_iters*num_subjs),
rep(het_conds_coef_list[[7]][1], num_iters*num_subjs),
rep(het_conds_coef_list[[8]][1], num_iters*num_subjs),
rep(het_conds_coef_list[[9]][1], num_iters*num_subjs),
rep(het_conds_coef_list[[10]][1], num_iters*num_subjs))
coef_Age = c(rep(het_conds_coef_list[[1]][2], num_iters*num_subjs),
rep(het_conds_coef_list[[2]][2], num_iters*num_subjs),
rep(het_conds_coef_list[[3]][2], num_iters*num_subjs),
rep(het_conds_coef_list[[4]][2], num_iters*num_subjs),
rep(het_conds_coef_list[[5]][2], num_iters*num_subjs),
rep(het_conds_coef_list[[6]][2], num_iters*num_subjs),
rep(het_conds_coef_list[[7]][2], num_iters*num_subjs),
rep(het_conds_coef_list[[8]][2], num_iters*num_subjs),
rep(het_conds_coef_list[[9]][2], num_iters*num_subjs),
rep(het_conds_coef_list[[10]][2], num_iters*num_subjs))
coef_Female = c(rep(het_conds_coef_list[[1]][3], num_iters*num_subjs),
rep(het_conds_coef_list[[2]][3], num_iters*num_subjs),
rep(het_conds_coef_list[[3]][3], num_iters*num_subjs),
rep(het_conds_coef_list[[4]][3], num_iters*num_subjs),
rep(het_conds_coef_list[[5]][3], num_iters*num_subjs),
rep(het_conds_coef_list[[6]][3], num_iters*num_subjs),
rep(het_conds_coef_list[[7]][3], num_iters*num_subjs),
rep(het_conds_coef_list[[8]][3], num_iters*num_subjs),
rep(het_conds_coef_list[[9]][3], num_iters*num_subjs),
rep(het_conds_coef_list[[10]][3], num_iters*num_subjs))
coef_BMI = c(rep(het_conds_coef_list[[1]][4], num_iters*num_subjs),
rep(het_conds_coef_list[[2]][4], num_iters*num_subjs),
rep(het_conds_coef_list[[3]][4], num_iters*num_subjs),
rep(het_conds_coef_list[[4]][4], num_iters*num_subjs),
rep(het_conds_coef_list[[5]][4], num_iters*num_subjs),
rep(het_conds_coef_list[[6]][4], num_iters*num_subjs),
rep(het_conds_coef_list[[7]][4], num_iters*num_subjs),
rep(het_conds_coef_list[[8]][4], num_iters*num_subjs),
rep(het_conds_coef_list[[9]][4], num_iters*num_subjs),
rep(het_conds_coef_list[[10]][4], num_iters*num_subjs))
coef_Liver_Mets = c(rep(het_conds_coef_list[[1]][5], num_iters*num_subjs),
rep(het_conds_coef_list[[2]][5], num_iters*num_subjs),
rep(het_conds_coef_list[[3]][5], num_iters*num_subjs),
rep(het_conds_coef_list[[4]][5], num_iters*num_subjs),
rep(het_conds_coef_list[[5]][5], num_iters*num_subjs),
rep(het_conds_coef_list[[6]][5], num_iters*num_subjs),
rep(het_conds_coef_list[[7]][5], num_iters*num_subjs),
rep(het_conds_coef_list[[8]][5], num_iters*num_subjs),
rep(het_conds_coef_list[[9]][5], num_iters*num_subjs),
rep(het_conds_coef_list[[10]][5], num_iters*num_subjs))
coef_Hepatic_Imp = c(rep(het_conds_coef_list[[1]][6], num_iters*num_subjs),
rep(het_conds_coef_list[[2]][6], num_iters*num_subjs),
rep(het_conds_coef_list[[3]][6], num_iters*num_subjs),
rep(het_conds_coef_list[[4]][6], num_iters*num_subjs),
rep(het_conds_coef_list[[5]][6], num_iters*num_subjs),
rep(het_conds_coef_list[[6]][6], num_iters*num_subjs),
rep(het_conds_coef_list[[7]][6], num_iters*num_subjs),
rep(het_conds_coef_list[[8]][6], num_iters*num_subjs),
rep(het_conds_coef_list[[9]][6], num_iters*num_subjs),
rep(het_conds_coef_list[[10]][6], num_iters*num_subjs))
coef_Num_Mets_MoreThan2 = c(rep(het_conds_coef_list[[1]][7], num_iters*num_subjs),
rep(het_conds_coef_list[[2]][7], num_iters*num_subjs),
rep(het_conds_coef_list[[3]][7], num_iters*num_subjs),
rep(het_conds_coef_list[[4]][7], num_iters*num_subjs),
rep(het_conds_coef_list[[5]][7], num_iters*num_subjs),
rep(het_conds_coef_list[[6]][7], num_iters*num_subjs),
rep(het_conds_coef_list[[7]][7], num_iters*num_subjs),
rep(het_conds_coef_list[[8]][7], num_iters*num_subjs),
rep(het_conds_coef_list[[9]][7], num_iters*num_subjs),
rep(het_conds_coef_list[[10]][7], num_iters*num_subjs))
coef_U = c(rep(het_conds_coef_list[[1]][8], num_iters*num_subjs),
rep(het_conds_coef_list[[2]][8], num_iters*num_subjs),
rep(het_conds_coef_list[[3]][8], num_iters*num_subjs),
rep(het_conds_coef_list[[4]][8], num_iters*num_subjs),
rep(het_conds_coef_list[[5]][8], num_iters*num_subjs),
rep(het_conds_coef_list[[6]][8], num_iters*num_subjs),
rep(het_conds_coef_list[[7]][8], num_iters*num_subjs),
rep(het_conds_coef_list[[8]][8], num_iters*num_subjs),
rep(het_conds_coef_list[[9]][8], num_iters*num_subjs),
rep(het_conds_coef_list[[10]][8], num_iters*num_subjs))
v = runif(n=N)
C = rexp(n=N, rate=rateC)
data_full <- data_full |>
mutate(v=v,
coef_I = coef_I,
coef_Age = coef_Age,
coef_Female = coef_Female,
coef_BMI = coef_BMI,
coef_Liver_Mets = coef_Liver_Mets,
coef_Hepatic_Imp = coef_Hepatic_Imp,
coef_Num_Mets_MoreThan2 = coef_Num_Mets_MoreThan2,
coef_U = coef_U,
C=C)
data_full <- data_full |>
mutate(exp_prod_sum = exp(coef_I*Intercept + coef_Age*Age +
coef_Female*Female + coef_BMI*BMI +
coef_Liver_Mets*Liver_Mets + coef_Hepatic_Imp*Hepatic_Imp +
coef_Num_Mets_MoreThan2*Num_Mets_MoreThan2 + coef_U*U))
data_full <- data_full |>
mutate(Tlat = (-log(v)/(lambda*exp_prod_sum))^(1/rho))
data_full <- data_full |>
mutate(time = pmin(Tlat, C),
status = as.numeric(Tlat <= C))
data_250 <- data_full
num_subjs <- 300 # number of different subjects
data_full <- expand.grid(1:num_subjs, 1:num_iters, 1:num_het_conds)
names(data_full) <- c("ID", "Iteration", "Heterogeneity_Level")
data_full <- data_full |>
dplyr::select("Heterogeneity_Level", "Iteration", "ID")
data_full <- data_full |>
mutate(`Heterogeneity_Level_Description` = case_when(`Heterogeneity_Level`==1~"80% less",
`Heterogeneity_Level`==2~"50% less",
`Heterogeneity_Level`==3~"20% less",
`Heterogeneity_Level`==4~"10% less",
`Heterogeneity_Level`==5~"Same",
`Heterogeneity_Level`==6~"10% more",
`Heterogeneity_Level`==7~"20% more",
`Heterogeneity_Level`==8~"50% more",
`Heterogeneity_Level`==9~"80% more",
`Heterogeneity_Level`==10~"Opposite"))
data_full <- data_full |>
dplyr::select("Heterogeneity_Level_Description", "Heterogeneity_Level", "Iteration", "ID")
# Let's simulate the covariates.
N=num_het_conds*num_iters*num_subjs
# 6 baseline measured covariates
age <- rnorm(n=N, mean=60, sd=10) |> round(0)
female <- rbern(n=N, prob=0.25)
bmi <- rnorm(n=N, mean=22, sd=4) |> round(3)
liver_mets <- rbern(n=N, prob=0.60)
hepatic_imp <- rbern(n=N, prob=0.20)
num_mets_morethan2 <- rbern(n=N, prob=0.85)
# 1 baseline unmeasured covariate
u <- rnorm(n=N, mean=0, sd=1)
data_full <- data_full |>
mutate(Intercept=1,
Age=age,
Female=female,
BMI=bmi,
Liver_Mets=liver_mets,
Hepatic_Imp=hepatic_imp,
Num_Mets_MoreThan2=num_mets_morethan2,
U=u)
# Outcome simulation constants.
# lambda = scale parameter in baseline weibull distribution.
# rho = shape parameter in baseline weibull distribution.
# rateC = rate parameter of the exponential distribution of censoring times.
lambda = 0.01
rho = 1
rateC = 0.005
coef_I = c(rep(het_conds_coef_list[[1]][1], num_iters*num_subjs),
rep(het_conds_coef_list[[2]][1], num_iters*num_subjs),
rep(het_conds_coef_list[[3]][1], num_iters*num_subjs),
rep(het_conds_coef_list[[4]][1], num_iters*num_subjs),
rep(het_conds_coef_list[[5]][1], num_iters*num_subjs),
rep(het_conds_coef_list[[6]][1], num_iters*num_subjs),
rep(het_conds_coef_list[[7]][1], num_iters*num_subjs),
rep(het_conds_coef_list[[8]][1], num_iters*num_subjs),
rep(het_conds_coef_list[[9]][1], num_iters*num_subjs),
rep(het_conds_coef_list[[10]][1], num_iters*num_subjs))
coef_Age = c(rep(het_conds_coef_list[[1]][2], num_iters*num_subjs),
rep(het_conds_coef_list[[2]][2], num_iters*num_subjs),
rep(het_conds_coef_list[[3]][2], num_iters*num_subjs),
rep(het_conds_coef_list[[4]][2], num_iters*num_subjs),
rep(het_conds_coef_list[[5]][2], num_iters*num_subjs),
rep(het_conds_coef_list[[6]][2], num_iters*num_subjs),
rep(het_conds_coef_list[[7]][2], num_iters*num_subjs),
rep(het_conds_coef_list[[8]][2], num_iters*num_subjs),
rep(het_conds_coef_list[[9]][2], num_iters*num_subjs),
rep(het_conds_coef_list[[10]][2], num_iters*num_subjs))
coef_Female = c(rep(het_conds_coef_list[[1]][3], num_iters*num_subjs),
rep(het_conds_coef_list[[2]][3], num_iters*num_subjs),
rep(het_conds_coef_list[[3]][3], num_iters*num_subjs),
rep(het_conds_coef_list[[4]][3], num_iters*num_subjs),
rep(het_conds_coef_list[[5]][3], num_iters*num_subjs),
rep(het_conds_coef_list[[6]][3], num_iters*num_subjs),
rep(het_conds_coef_list[[7]][3], num_iters*num_subjs),
rep(het_conds_coef_list[[8]][3], num_iters*num_subjs),
rep(het_conds_coef_list[[9]][3], num_iters*num_subjs),
rep(het_conds_coef_list[[10]][3], num_iters*num_subjs))
coef_BMI = c(rep(het_conds_coef_list[[1]][4], num_iters*num_subjs),
rep(het_conds_coef_list[[2]][4], num_iters*num_subjs),
rep(het_conds_coef_list[[3]][4], num_iters*num_subjs),
rep(het_conds_coef_list[[4]][4], num_iters*num_subjs),
rep(het_conds_coef_list[[5]][4], num_iters*num_subjs),
rep(het_conds_coef_list[[6]][4], num_iters*num_subjs),
rep(het_conds_coef_list[[7]][4], num_iters*num_subjs),
rep(het_conds_coef_list[[8]][4], num_iters*num_subjs),
rep(het_conds_coef_list[[9]][4], num_iters*num_subjs),
rep(het_conds_coef_list[[10]][4], num_iters*num_subjs))
coef_Liver_Mets = c(rep(het_conds_coef_list[[1]][5], num_iters*num_subjs),
rep(het_conds_coef_list[[2]][5], num_iters*num_subjs),
rep(het_conds_coef_list[[3]][5], num_iters*num_subjs),
rep(het_conds_coef_list[[4]][5], num_iters*num_subjs),
rep(het_conds_coef_list[[5]][5], num_iters*num_subjs),
rep(het_conds_coef_list[[6]][5], num_iters*num_subjs),
rep(het_conds_coef_list[[7]][5], num_iters*num_subjs),
rep(het_conds_coef_list[[8]][5], num_iters*num_subjs),
rep(het_conds_coef_list[[9]][5], num_iters*num_subjs),
rep(het_conds_coef_list[[10]][5], num_iters*num_subjs))
coef_Hepatic_Imp = c(rep(het_conds_coef_list[[1]][6], num_iters*num_subjs),
rep(het_conds_coef_list[[2]][6], num_iters*num_subjs),
rep(het_conds_coef_list[[3]][6], num_iters*num_subjs),
rep(het_conds_coef_list[[4]][6], num_iters*num_subjs),
rep(het_conds_coef_list[[5]][6], num_iters*num_subjs),
rep(het_conds_coef_list[[6]][6], num_iters*num_subjs),
rep(het_conds_coef_list[[7]][6], num_iters*num_subjs),
rep(het_conds_coef_list[[8]][6], num_iters*num_subjs),
rep(het_conds_coef_list[[9]][6], num_iters*num_subjs),
rep(het_conds_coef_list[[10]][6], num_iters*num_subjs))
coef_Num_Mets_MoreThan2 = c(rep(het_conds_coef_list[[1]][7], num_iters*num_subjs),
rep(het_conds_coef_list[[2]][7], num_iters*num_subjs),
rep(het_conds_coef_list[[3]][7], num_iters*num_subjs),
rep(het_conds_coef_list[[4]][7], num_iters*num_subjs),
rep(het_conds_coef_list[[5]][7], num_iters*num_subjs),
rep(het_conds_coef_list[[6]][7], num_iters*num_subjs),
rep(het_conds_coef_list[[7]][7], num_iters*num_subjs),
rep(het_conds_coef_list[[8]][7], num_iters*num_subjs),
rep(het_conds_coef_list[[9]][7], num_iters*num_subjs),
rep(het_conds_coef_list[[10]][7], num_iters*num_subjs))
coef_U = c(rep(het_conds_coef_list[[1]][8], num_iters*num_subjs),
rep(het_conds_coef_list[[2]][8], num_iters*num_subjs),
rep(het_conds_coef_list[[3]][8], num_iters*num_subjs),
rep(het_conds_coef_list[[4]][8], num_iters*num_subjs),
rep(het_conds_coef_list[[5]][8], num_iters*num_subjs),
rep(het_conds_coef_list[[6]][8], num_iters*num_subjs),
rep(het_conds_coef_list[[7]][8], num_iters*num_subjs),
rep(het_conds_coef_list[[8]][8], num_iters*num_subjs),
rep(het_conds_coef_list[[9]][8], num_iters*num_subjs),
rep(het_conds_coef_list[[10]][8], num_iters*num_subjs))
v = runif(n=N)
C = rexp(n=N, rate=rateC)
data_full <- data_full |>
mutate(v=v,
coef_I = coef_I,
coef_Age = coef_Age,
coef_Female = coef_Female,
coef_BMI = coef_BMI,
coef_Liver_Mets = coef_Liver_Mets,
coef_Hepatic_Imp = coef_Hepatic_Imp,
coef_Num_Mets_MoreThan2 = coef_Num_Mets_MoreThan2,
coef_U = coef_U,
C=C)
data_full <- data_full |>
mutate(exp_prod_sum = exp(coef_I*Intercept + coef_Age*Age +
coef_Female*Female + coef_BMI*BMI +
coef_Liver_Mets*Liver_Mets + coef_Hepatic_Imp*Hepatic_Imp +
coef_Num_Mets_MoreThan2*Num_Mets_MoreThan2 + coef_U*U))
data_full <- data_full |>
mutate(Tlat = (-log(v)/(lambda*exp_prod_sum))^(1/rho))
data_full <- data_full |>
mutate(time = pmin(Tlat, C),
status = as.numeric(Tlat <= C))
data_300 <- data_full
# Let's add a column for sample size and study.
data_100 <- data_100 |>
mutate(Sample_Size= 100,
Study = 3)
data_150 <- data_150 |>
mutate(Sample_Size= 150,
Study = 3)
data_200 <- data_200 |>
mutate(Sample_Size= 200,
Study = 3)
data_250 <- data_250 |>
mutate(Sample_Size= 250,
Study = 3)
data_300 <- data_300 |>
mutate(Sample_Size= 300,
Study = 3)
data_all <- rbind(data_100, data_150, data_200, data_250, data_300)
# Let's choose only columns that what we need.
data_all <- data_all |>
dplyr::select("Sample_Size", "Heterogeneity_Level",
"Iteration",
"Study",
"ID",
"Age", "Female", "BMI", "Liver_Mets", "Hepatic_Imp", "Num_Mets_MoreThan2",
"status", "time")
names(data_all) <- c("Sample_Size", "Heterogeneity_Level",
"Iteration",
"Study",
"ID",
"Age", "Female", "BMI", "Liver_Mets", "Hepatic_Imp", "Num_Mets_MoreThan2",
"composite", "follow_up_time_composite_in_days_RS")
dg1 <- read.csv("H:/ravi_dsi_summer_project/bdb_analysis_V2/DG-01.csv")
dg2 <- read.csv("H:/ravi_dsi_summer_project/bdb_analysis_V2/DG-02.csv")
dg1 <- dg1 |>
dplyr::select("Study",
"ID",
"Age", "Female", "BMI", "Liver_Mets", "Hepatic_Imp", "Num_Mets_MoreThan2",
"composite", "follow_up_time_composite_in_days_RS")
dg2 <- dg2 |>
dplyr::select("Study",
"ID",
"Age", "Female", "BMI", "Liver_Mets", "Hepatic_Imp", "Num_Mets_MoreThan2",
"composite", "follow_up_time_composite_in_days_RS")
write.csv(dg1, "H:/ravi_dsi_summer_project/bdb_analysis_V1/dg1.csv")
write.csv(dg2, "H:/ravi_dsi_summer_project/bdb_analysis_V1/dg2.csv")
write.csv(data_all, "H:/ravi_dsi_summer_project/bdb_analysis_V1/data_all.csv")
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
source("H:/ravi_dsi_summer_project/libraries_and_functions.R")
data_all <- read.csv("H:/ravi_dsi_summer_project/bdb_analysis_V1/data_all.csv")
dg1 <- read.csv("H:/ravi_dsi_summer_project/bdb_analysis_V1/dg1.csv")
dg2 <- read.csv("H:/ravi_dsi_summer_project/bdb_analysis_V1/dg2.csv")
data_all$X <- NULL
dg1$X <- NULL
dg2$X <- NULL
# Preparing the one single instance of simulated data.
data_all_1 <- data_all |>
filter(Sample_Size==100,
Heterogeneity_Level==1,
Iteration==1)
data_all_1 <- data_all_1 |>
dplyr::select(-c("Sample_Size", "Heterogeneity_Level","Iteration"))
# Data with all 3 studies combined.
df <- rbind(dg1, dg2, data_all_1)
data.stan <- function(dat_combined) {
dat <- dat_combined[rank(dat_combined$Study, ties.method = 'first'), ]
x <- cbind(Intercept = 1, dat[, 3:8])
status <- dat$composite
time <- dat$follow_up_time_composite_in_days_RS
study <- dat$Study
N <- nrow(x) # number of patients
M <- ncol(x) # number of covariates + intercept
S <- length(unique(study)) # number of studies
NN <- sum(study == 3) # number of patients in prosperity
list(N = N, M = M, S = S, NN = NN, x = x, status = status, time = time, study = study)
}
data.stan(df)
data.stan(df) |> View()
data.stan(df) |> length()
data.stan(df)[[6]] |> unique()
